<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS PARKING - Dashboard Profesional</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <style>
        /* VARIABLES DE COLOR ORIGINALES */
        :root {
            --primary-blue: #3498db;
            --dark-bg: #0a0a0b;
            --panel-bg: #161618;
            --card-bg: #1f1f23;
            --text-main: #ffffff;
            --text-dim: #a0a0a0;
            --success: #2ecc71;
            --danger: #e74c3c;
            --warning: #f1c40f;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Montserrat', sans-serif;
            background-color: var(--dark-bg);
            color: var(--text-main);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* BARRA LATERAL IZQUIERDA (ESTRUCTURA ORIGINAL) */
        .sidebar {
            width: 320px;
            background-color: var(--panel-bg);
            border-right: 1px solid #2a2a2e;
            display: flex;
            flex-direction: column;
            padding: 30px 20px;
            box-sizing: border-box;
            box-shadow: 5px 0 15px rgba(0,0,0,0.5);
        }

        .sidebar-brand {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 50px;
        }

        .sidebar-p-logo {
            background-color: var(--primary-blue);
            color: white;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            font-weight: 900;
            font-size: 26px;
        }

        .sidebar-brand-text {
            font-weight: 700;
            font-size: 1.3rem;
            letter-spacing: 0.5px;
        }

        .menu-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            margin-bottom: 8px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-dim);
            font-weight: 600;
        }

        .menu-item:hover, .menu-item.active {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--primary-blue);
        }

        .status-panel {
            margin-top: auto;
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid #2a2a2e;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.85rem;
            margin-top: 10px;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--warning);
        }

        /* CONTENIDO PRINCIPAL (DERECHA) */
        .main-view {
            flex-grow: 1;
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-y: auto;
        }

        /* EL T√çTULO QUE ME HAS PEDIDO LITERALMENTE */
        .header-section {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 25px;
            margin-bottom: 40px;
            width: 100%;
        }

        .big-p-logo {
            background-color: var(--primary-blue);
            color: white;
            width: 65px;
            height: 65px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            font-weight: 900;
            font-size: 40px;
            box-shadow: 0 0 25px rgba(52, 152, 219, 0.4);
        }

        .big-title {
            font-weight: 900;
            font-size: 2.4rem;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* CONTENEDOR DE TU IMAGEN logo_parking.jpg */
        .parking-container {
            position: relative;
            width: 950px;
            height: 550px;
            background: url('/static/img/logo_parking.jpg') no-repeat center center;
            background-size: contain;
            background-color: #000;
            border-radius: 25px;
            border: 5px solid #1f1f23;
            box-shadow: 0 30px 60px rgba(0,0,0,0.8);
        }

        /* LAS PLAZAS (C√çRCULOS) */
        .slot {
            position: absolute;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 3px solid #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }

        .slot.free {
            background-color: var(--success);
            box-shadow: 0 0 20px rgba(46, 204, 113, 0.6);
        }

        .slot.occupied {
            background-color: var(--danger);
            box-shadow: 0 0 20px rgba(231, 76, 60, 0.6);
            transform: scale(1.15);
        }

        /* COORDENADAS (COMO ANTES, AJUSTALAS SI ES NECESARIO) */
        #p2 { top: 120px; left: 180px; }
        #p3 { top: 120px; left: 330px; }
        #p4 { top: 120px; left: 480px; }
        #p5 { top: 380px; left: 180px; }
        #p6 { top: 380px; left: 330px; }
        #p7 { top: 380px; left: 480px; }

        .btn-logout {
            margin-top: 30px;
            padding: 15px;
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--danger);
            text-decoration: none;
            text-align: center;
            border-radius: 12px;
            border: 1px solid var(--danger);
            font-weight: 700;
            transition: 0.3s;
        }

        .btn-logout:hover {
            background-color: var(--danger);
            color: white;
        }

    </style>
</head>
<body>

    <div class="sidebar">
        <div class="sidebar-brand">
            <div class="sidebar-p-logo">P</div>
            <div class="sidebar-brand-text">NEXUS PANEL</div>
        </div>

        <div class="menu-list">
            <div class="menu-item active"><span>üè†</span> Vista General</div>
            <div class="menu-item"><span>üìä</span> Estad√≠sticas</div>
            <div class="menu-item"><span>üõ°Ô∏è</span> Seguridad</div>
            <div class="menu-item"><span>‚öôÔ∏è</span> Ajustes</div>
        </div>

        <div class="status-panel">
            <h5 style="margin:0; color:var(--text-dim)">CONECTIVIDAD</h5>
            <div class="status-indicator">
                <div class="dot" id="server-dot" style="background-color: var(--success);"></div>
                <span>Servidor Cloud: Activo</span>
            </div>
            <div class="status-indicator">
                <div class="dot" id="arduino-dot"></div>
                <span>Arduino: <span id="arduino-text">Buscando...</span></span>
            </div>
        </div>

        <a href="/logout" class="btn-logout">CERRAR SESI√ìN</a>
    </div>

    <div class="main-view">
        
        <div class="header-section">
            <div class="big-p-logo">P</div>
            <h1 class="big-title">
                PARKING CENTRO COMERCIAL <span style="color: var(--primary-blue);">NEXUS</span>
            </h1>
        </div>

        <div class="parking-container">
            <div id="p2" class="slot free">2</div>
            <div id="p3" class="slot free">3</div>
            <div id="p4" class="slot free">4</div>
            <div id="p5" class="slot free">5</div>
            <div id="p6" class="slot free">6</div>
            <div id="p7" class="slot free">7</div>
        </div>

        <div style="margin-top: 40px; display: flex; gap: 40px; background: var(--panel-bg); padding: 15px 30px; border-radius: 20px;">
            <div style="display: flex; align-items: center; gap: 12px;">
                <div style="width: 15px; height: 15px; background: var(--success); border-radius: 3px;"></div>
                <span style="font-weight: 600;">LIBRE</span>
            </div>
            <div style="display: flex; align-items: center; gap: 12px;">
                <div style="width: 15px; height: 15px; background: var(--danger); border-radius: 3px;"></div>
                <span style="font-weight: 600;">OCUPADO</span>
            </div>
        </div>
    </div>

    <script>
        async function fetchStatus() {
            try {
                const response = await fetch('/status');
                const data = await response.json();
                
                // Actualizar luces del panel lateral
                document.getElementById('arduino-dot').style.background = '#2ecc71';
                document.getElementById('arduino-text').innerText = 'Conectado';

                // Actualizar cada plaza
                for (let key in data) {
                    const slotElement = document.getElementById(key);
                    if (slotElement) {
                        if (data[key] === 1) {
                            slotElement.classList.remove('free');
                            slotElement.classList.add('occupied');
                        } else {
                            slotElement.classList.remove('occupied');
                            slotElement.classList.add('free');
                        }
                    }
                }
            } catch (error) {
                document.getElementById('arduino-dot').style.background = '#e74c3c';
                document.getElementById('arduino-text').innerText = 'Error';
            }
        }

        // Llamada cada 2 segundos
        setInterval(fetchStatus, 2000);
        fetchStatus();
    </script>
</body>
</html>
